<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PulseFit Pro</title>
    
    <!-- PWA Meta Tags -->
    <link rel="manifest" href="/workout-app/manifest.json">
    <meta name="theme-color" content="#0a0a0a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="PulseFit">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/2964/2964514.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      // Fallback if Tailwind CDN fails
      if (typeof tailwind === 'undefined') {
        console.warn('Tailwind CDN failed to load');
      }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0a0a0a;
            color: #ffffff;
            overscroll-behavior-y: contain;
            -webkit-tap-highlight-color: transparent;
        }
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1a1a1a;
        }
        ::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #444;
        }
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        /* Custom Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: 0.8;
                transform: scale(1.05);
            }
        }
        
        @keyframes gradientShift {
            0%, 100% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
        }
        
        @keyframes shimmer {
            0% {
                background-position: -1000px 0;
            }
            100% {
                background-position: 1000px 0;
            }
        }
        
        @keyframes float {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-10px);
            }
        }
        
        .animate-fade-in-up {
            animation: fadeInUp 0.6s ease-out forwards;
        }
        
        .animate-fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }
        
        .animate-slide-in-right {
            animation: slideInRight 0.5s ease-out forwards;
        }
        
        .animate-pulse-slow {
            animation: pulse 2s ease-in-out infinite;
        }
        
        .animate-gradient {
            background-size: 200% 200%;
            animation: gradientShift 3s ease infinite;
        }
        
        .animate-shimmer {
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            background-size: 200% 100%;
            animation: shimmer 2s infinite;
        }
        
        .animate-float {
            animation: float 3s ease-in-out infinite;
        }
        
        /* Stagger animation delays */
        .stagger-1 { animation-delay: 0.1s; opacity: 0; }
        .stagger-2 { animation-delay: 0.2s; opacity: 0; }
        .stagger-3 { animation-delay: 0.3s; opacity: 0; }
        .stagger-4 { animation-delay: 0.4s; opacity: 0; }
        .stagger-5 { animation-delay: 0.5s; opacity: 0; }
        .stagger-6 { animation-delay: 0.6s; opacity: 0; }
        
        /* Glassmorphism */
        .glass {
            background: rgba(17, 17, 17, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* 3D Transform */
        .transform-3d {
            transform-style: preserve-3d;
            perspective: 1000px;
        }
        
        .hover-lift {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .hover-lift:hover {
            transform: translateY(-8px) rotateX(2deg);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        }
    </style>
</head>
<body>
    <div id="root">
      <div style="display: flex; align-items: center; justify-content: center; height: 100vh; background: #0a0a0a; color: white; font-family: Inter, sans-serif;">
        <div style="text-align: center;">
          <div style="width: 50px; height: 50px; border: 4px solid #333; border-top-color: #3b82f6; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 20px;"></div>
          <p>Loading PulseFit Pro...</p>
        </div>
      </div>
    </div>
    <style>
      @keyframes spin {
        to { transform: rotate(360deg); }
      }
    </style>
    <script>
      // Handle GitHub Pages redirect
      (function() {
        const redirect = sessionStorage.redirect;
        delete sessionStorage.redirect;
        if (redirect && redirect !== location.href) {
          history.replaceState(null, null, redirect);
        }
      })();
      
      // Error handling
      window.addEventListener('error', (e) => {
        console.error('Global error:', e.error, e.filename, e.lineno, e.colno);
        const root = document.getElementById('root');
        if (root && root.children.length === 1) {
          const errorMsg = e.error ? e.error.toString() : (e.message || 'Unknown error');
          const errorDetails = e.filename ? `File: ${e.filename}:${e.lineno}:${e.colno}` : '';
          root.innerHTML = '<div style="display: flex; align-items: center; justify-content: center; height: 100vh; background: #0a0a0a; color: white; font-family: Inter, sans-serif; padding: 20px; text-align: center;"><div><h1 style="color: #ef4444; margin-bottom: 20px;">Error Loading App</h1><p style="color: #888;">' + errorMsg + '</p><p style="color: #666; font-size: 12px; margin-top: 10px;">' + errorDetails + '</p><pre style="color: #666; font-size: 12px; margin-top: 20px; text-align: left; background: #111; padding: 10px; border-radius: 4px; overflow: auto; max-width: 600px; margin: 20px auto 0;">' + (e.error && e.error.stack ? e.error.stack : String(e.error || e.message)) + '</pre></div></div>';
        }
      });
      
      // Unhandled promise rejection
      window.addEventListener('unhandledrejection', (e) => {
        console.error('Unhandled promise rejection:', e.reason);
        const root = document.getElementById('root');
        if (root && root.children.length === 1) {
          root.innerHTML = '<div style="display: flex; align-items: center; justify-content: center; height: 100vh; background: #0a0a0a; color: white; font-family: Inter, sans-serif; padding: 20px; text-align: center;"><div><h1 style="color: #ef4444; margin-bottom: 20px;">Error Loading App</h1><p style="color: #888;">Promise rejection: ' + (e.reason ? e.reason.toString() : 'Unknown') + '</p></div></div>';
        }
      });
      
      // Timeout check - if app doesn't load in 10 seconds, show error
      setTimeout(() => {
        const root = document.getElementById('root');
        if (root && root.children.length === 1 && root.children[0].textContent && root.children[0].textContent.includes('Loading')) {
          root.innerHTML = '<div style="display: flex; align-items: center; justify-content: center; height: 100vh; background: #0a0a0a; color: white; font-family: Inter, sans-serif; padding: 20px; text-align: center;"><div><h1 style="color: #ef4444; margin-bottom: 20px;">App Failed to Load</h1><p style="color: #888;">The app is taking too long to load. Please check the browser console for errors.</p><p style="color: #666; font-size: 12px; margin-top: 20px;">Path: ' + window.location.pathname + '</p><p style="color: #666; font-size: 12px;">Scripts loaded: ' + document.querySelectorAll(\'script[type="module"]\').length + '</p></div></div>';
        }
      }, 10000);
      
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          // Use base path for GitHub Pages
          const basePath = '/workout-app/';
          navigator.serviceWorker.register(basePath + 'sw.js').catch(err => console.log('SW registration failed:', err));
        });
      }
      
      // Debug: Log when script loads
      console.log('Index.html script loaded, base path:', window.location.pathname);
      
      // Check if module script loads
      window.addEventListener('DOMContentLoaded', () => {
        const moduleScripts = document.querySelectorAll('script[type="module"]');
        console.log('Module scripts found:', moduleScripts.length);
        moduleScripts.forEach((script, i) => {
          console.log(`Script ${i}:`, script.src || script.getAttribute('src'));
          script.addEventListener('error', (e) => {
            console.error('Script failed to load:', script.src || script.getAttribute('src'), e);
            const root = document.getElementById('root');
            if (root && root.children.length === 1) {
              root.innerHTML = '<div style="display: flex; align-items: center; justify-content: center; height: 100vh; background: #0a0a0a; color: white; font-family: Inter, sans-serif; padding: 20px; text-align: center;"><div><h1 style="color: #ef4444; margin-bottom: 20px;">Script Failed to Load</h1><p style="color: #888;">Failed to load: ' + (script.src || script.getAttribute('src') || 'unknown') + '</p><p style="color: #666; font-size: 12px; margin-top: 20px;">Check browser console and network tab for details.</p></div></div>';
            }
          });
        });
      });
    </script>
    <script type="module" src="./index.tsx"></script>
</body>
</html>
